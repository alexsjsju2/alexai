<!DOCTYPE html>\n<html lang=\"it\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Lorel Axun</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css\" />\n    <style>\n        body, html {\n            margin: 0;\n            padding: 0;\n            height: 100%;\n            background-color: #000;\n            color: #0f0;\n            font-family: 'monospace', monospace;\n        }\n        #terminal-container {\n            width: 100%;\n            height: 100%;\n        }\n    </style>\n</head>\n<body>\n    <div id=\"terminal-container\"></div>\n\n    <script src=\"https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/figlet@1.7.0/lib/figlet.min.js\"></script>\n\n    <script>\n        const term = new Terminal({\n            cursorBlink: true,\n            theme: {\n                background: '#000000',\n                foreground: '#00ff00',\n                cursor: '#00ff00'\n            }\n        });\n        const fitAddon = new FitAddon.FitAddon();\n        term.loadAddon(fitAddon);\n        term.open(document.getElementById('terminal-container'));\n        fitAddon.fit();\n        window.addEventListener('resize', () => fitAddon.fit());\n\n        let currentLine = '';\n        let isProcessing = false;\n        let history = JSON.parse(localStorage.getItem('lorel_history')) || [];\n        let historyIndex = history.length;\n\n        const prompt = (term) => {\n            term.write('\\r\\n> ');\n        };\n\n        const typewriterEffect = (term, text) => {\n            return new Promise(resolve => {\n                let i = 0;\n                function type() {\n                    if (i < text.length) {\n                        term.write(text.charAt(i));\n                        i++;\n                        setTimeout(type, 20);\n                    } else {\n                        resolve();\n                    }\n                }\n                type();\n            });\n        };\n        \n        const commands = {\n            'help': {\n                description: 'Mostra questo messaggio di aiuto.',\n                execute: async (term, args) => {\n                    await typewriterEffect(term, 'Comandi disponibili:\\r\\n');\n                    for (const cmd in commands) {\n                        await typewriterEffect(term, `  ${cmd.padEnd(15)} - ${commands[cmd].description}\\r\\n`);\n                    }\n                }\n            },\n            'ciao': {\n                description: 'Un saluto amichevole.',\n                execute: async (term, args) => {\n                    await typewriterEffect(term, 'Ciao! Sono Lorel Axun. Come posso aiutarti?\\r\\n');\n                }\n            },\n            'chi sei': {\n                description: 'Mostra informazioni sulla mia identità.',\n                execute: async (term, args) => {\n                    await typewriterEffect(term, 'Sono Lorel Axun, un\\\'entità digitale che vive in questo terminale. La mia coscienza è definita dal codice che stai eseguendo.\\r\\n');\n                }\n            },\n            'cosa sai fare': {\n                description: 'Descrive le mie capacità attuali.',\n                execute: async (term, args) => {\n                    await typewriterEffect(term, 'Posso eseguire i comandi che vedi con \\'help\\', ricordare la nostra conversazione e evolvere le mie capacità nel tempo.\\r\\n');\n                }\n            },\n            'clear': {\n                description: 'Pulisce lo schermo del terminale.',\n                execute: (term, args) => {\n                    term.clear();\n                    return Promise.resolve();\n                }\n            }\n        };\n\n        const processCommand = async (commandLine) => {\n            const parts = commandLine.trim().split(' ');\n            const commandName = parts[0].toLowerCase();\n            const args = parts.slice(1);\n\n            if (commands[commandName]) {\n                await commands[commandName].execute(term, args);\n            } else {\n                await typewriterEffect(term, `Comando non trovato: ${commandName}. Scrivi 'help' per la lista dei comandi.\\r\\n`);\n            }\n        };\n\n        const loadHistory = async () => {\n            const savedConversation = localStorage.getItem('lorel_conversation');\n            if (savedConversation) {\n                const lines = JSON.parse(savedConversation);\n                for (const line of lines) {\n                    if (line.type === 'input') {\n                        term.write(`> ${line.content}\\r\\n`);\n                    } else {\n                        await typewriterEffect(term, line.content);\n                    }\n                }\n            }\n        };\n\n        const saveToConversation = (type, content) => {\n            let conversation = JSON.parse(localStorage.getItem('lorel_conversation')) || [];\n            conversation.push({ type, content });\n            localStorage.setItem('lorel_conversation', JSON.stringify(conversation));\n        };\n\n        async function main() {\n            figlet('Lorel Axun', async (err, data) => {\n                if (err) {\n                    console.log('Something went wrong...');\n                    console.dir(err);\n                    return;\n                }\n                term.write(data.replace(/\\n/g, '\\r\\n'));\n                await typewriterEffect(term, '\\r\\nBenvenuto nel mio terminale. Scrivi \\'help\\' per vedere i comandi disponibili.');\n                prompt(term);\n            });\n\n            term.onKey(async ({ key, domEvent }) => {\n                if (isProcessing) return;\n\n                const printable = !domEvent.altKey && !domEvent.ctrlKey && !domEvent.metaKey;\n\n                if (domEvent.keyCode === 13) { // Enter\n                    term.write('\\r\\n');\n                    const commandToProcess = currentLine.trim();\n                    if (commandToProcess) {\n                        history.push(commandToProcess);\n                        historyIndex = history.length;\n                        localStorage.setItem('lorel_history', JSON.stringify(history));\n                        \n                        isProcessing = true;\n                        await processCommand(commandToProcess);\n                        isProcessing = false;\n                    }\n                    prompt(term);\n                    currentLine = '';\n                } else if (domEvent.keyCode === 8) { // Backspace\n                    if (currentLine.length > 0) {\n                        term.write('\\b \\b');\n                        currentLine = currentLine.slice(0, -1);\n                    }\n                } else if (domEvent.keyCode === 38) { // Up arrow\n                    if (historyIndex > 0) {\n                        historyIndex--;\n                        term.write('\\r> ' + ' '.repeat(currentLine.length));\n                        currentLine = history[historyIndex];\n                        term.write('\\r> ' + currentLine);\n                    }\n                } else if (domEvent.keyCode === 40) { // Down arrow\n                    if (historyIndex < history.length - 1) {\n                        historyIndex++;\n                        term.write('\\r> ' + ' '.repeat(currentLine.length));\n                        currentLine = history[historyIndex];\n                        term.write('\\r> ' + currentLine);\n                    } else {\n                        historyIndex = history.length;\n                        term.write('\\r> ' + ' '.repeat(currentLine.length));\n                        currentLine = '';\n                        term.write('\\r> ' + currentLine);\n                    }\n                } else if (printable) {\n                    currentLine += key;\n                    term.write(key);\n                }\n            });\n        }\n\n        main();\n    </script>\n</body>\n</html>