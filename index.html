<!DOCTYPE html>\n<html lang=\"it\" data-theme=\"dark\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Lorel Axun</title>\n    <script src=\"https://cdn.jsdelivr.net/npm/marked/marked.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/common.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/sentiment@5.0.2/lib/index.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/tsparticles@3.3.0/tsparticles.bundle.min.js\"></script>\n    <style>\n        :root {\n            --dark-bg: #0D0208;\n            --dark-text: #00FF41;\n            --dark-prompt: #00FF41;\n            --dark-header-bg: rgba(0, 0, 0, 0.5);\n            --dark-input-bg: rgba(0, 0, 0, 0.5);\n            --dark-scroll-thumb: #00FF41;\n            --dark-scroll-track: #0D0208;\n            --dark-button-bg: #00FF41;\n            --dark-button-text: #0D0208;\n\n            --light-bg: #F5F5F5;\n            --light-text: #1a1a1a;\n            --light-prompt: #1a1a1a;\n            --light-header-bg: rgba(255, 255, 255, 0.5);\n            --light-input-bg: rgba(255, 255, 255, 0.5);\n            --light-scroll-thumb: #1a1a1a;\n            --light-scroll-track: #F5F5F5;\n            --light-button-bg: #1a1a1a;\n            --light-button-text: #F5F5F5;\n        }\n\n        [data-theme=\"dark\"] {\n            --bg-color: var(--dark-bg);\n            --text-color: var(--dark-text);\n            --prompt-color: var(--dark-prompt);\n            --header-bg-color: var(--dark-header-bg);\n            --input-bg-color: var(--dark-input-bg);\n            --scrollbar-thumb-color: var(--dark-scroll-thumb);\n            --scrollbar-track-color: var(--dark-scroll-track);\n            --button-bg-color: var(--dark-button-bg);\n            --button-text-color: var(--dark-button-text);\n        }\n\n        [data-theme=\"light\"] {\n            --bg-color: var(--light-bg);\n            --text-color: var(--light-text);\n            --prompt-color: var(--light-prompt);\n            --header-bg-color: var(--light-header-bg);\n            --input-bg-color: var(--light-input-bg);\n            --scrollbar-thumb-color: var(--light-scroll-thumb);\n            --scrollbar-track-color: var(--light-scroll-track);\n            --button-bg-color: var(--light-button-bg);\n            --button-text-color: var(--light-button-text);\n        }\n\n        * {\n            box-sizing: border-box;\n            margin: 0;\n            padding: 0;\n        }\n\n        html, body {\n            height: 100%;\n            overflow: hidden;\n        }\n\n        body {\n            font-family: 'Courier New', Courier, monospace;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n            display: flex;\n            flex-direction: column;\n            transition: background-color 0.3s, color 0.3s;\n        }\n\n        #tsparticles {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            z-index: -1;\n        }\n\n        .chat-container {\n            display: flex;\n            flex-direction: column;\n            height: 100vh;\n            width: 100%;\n            max-width: 900px;\n            margin: 0 auto;\n            padding: 10px;\n        }\n\n        .chat-header {\n            padding: 10px;\n            text-align: center;\n            flex-shrink: 0;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            background-color: var(--header-bg-color);\n            backdrop-filter: blur(5px);\n            border-bottom: 1px solid var(--text-color);\n        }\n\n        .chat-header h1 {\n            font-size: 1.5em;\n            font-weight: normal;\n        }\n\n        #theme-toggle-button {\n            background: none;\n            border: 1px solid var(--text-color);\n            color: var(--text-color);\n            padding: 5px 10px;\n            cursor: pointer;\n            font-family: inherit;\n        }\n\n        #chat-messages {\n            flex-grow: 1;\n            overflow-y: auto;\n            padding: 10px;\n            word-wrap: break-word;\n        }\n\n        #chat-messages::-webkit-scrollbar {\n            width: 8px;\n        }\n\n        #chat-messages::-webkit-scrollbar-track {\n            background: var(--scrollbar-track-color);\n        }\n\n        #chat-messages::-webkit-scrollbar-thumb {\n            background-color: var(--scrollbar-thumb-color);\n        }\n\n        .message-block {\n            margin-bottom: 15px;\n        }\n\n        .user-prompt::before {\n            content: 'user@lorel:~$ ';\n            color: var(--prompt-color);\n        }\n\n        .ai-message pre {\n            background-color: rgba(0, 0, 0, 0.3);\n            padding: 15px;\n            margin: 10px 0;\n            overflow-x: auto;\n            border: 1px solid var(--text-color);\n            position: relative;\n        }\n\n        .ai-message code {\n            font-family: 'Courier New', Courier, monospace;\n        }\n\n        .copy-button {\n            position: absolute;\n            top: 5px;\n            right: 5px;\n            background-color: var(--button-bg-color);\n            color: var(--button-text-color);\n            border: none;\n            padding: 3px 8px;\n            cursor: pointer;\n            opacity: 0;\n            transition: opacity 0.2s;\n        }\n\n        .ai-message pre:hover .copy-button {\n            opacity: 1;\n        }\n\n        .typing-indicator {\n            display: flex;\n            align-items: center;\n        }\n\n        .typing-indicator span {\n            height: 8px;\n            width: 8px;\n            margin: 0 2px;\n            background-color: var(--text-color);\n            border-radius: 50%;\n            display: inline-block;\n            animation: bounce 1.4s infinite ease-in-out both;\n        }\n\n        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }\n        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }\n\n        @keyframes bounce {\n            0%, 80%, 100% { transform: scale(0); }\n            40% { transform: scale(1.0); }\n        }\n\n        .typing-cursor {\n            display: inline-block;\n            width: 10px;\n            height: 1.2em;\n            background-color: var(--text-color);\n            animation: blink 1s step-end infinite;\n            vertical-align: bottom;\n        }\n\n        @keyframes blink {\n            from, to { background-color: transparent; }\n            50% { background-color: var(--text-color); }\n        }\n\n        .chat-input {\n            display: flex;\n            padding: 10px;\n            flex-shrink: 0;\n            background-color: var(--input-bg-color);\n            backdrop-filter: blur(5px);\n            border-top: 1px solid var(--text-color);\n        }\n\n        #user-input {\n            flex-grow: 1;\n            background: transparent;\n            border: none;\n            color: var(--text-color);\n            font-family: 'Courier New', Courier, monospace;\n            font-size: 1em;\n            resize: none;\n            padding: 10px;\n            outline: none;\n        }\n\n        #send-button {\n            background-color: transparent;\n            color: var(--text-color);\n            border: 1px solid var(--text-color);\n            padding: 10px 15px;\n            cursor: pointer;\n            font-family: inherit;\n            margin-left: 10px;\n        }\n    </style>\n</head>\n<body>\n\n    <div id=\"tsparticles\"></div>\n\n    <div class=\"chat-container\">\n        <header class=\"chat-header\">\n            <h1>Lorel Axun</h1>\n            <button id=\"theme-toggle-button\">Switch Theme</button>\n        </header>\n        <div id=\"chat-messages\"></div>\n        <div class=\"chat-input\">\n            <textarea id=\"user-input\" placeholder=\"Type your command...\" rows=\"1\"></textarea>\n            <button id=\"send-button\">SEND</button>\n        </div>\n    </div>\n\n    <script>\n        document.addEventListener('DOMContentLoaded', () => {\n            const chatMessages = document.getElementById('chat-messages');\n            const userInput = document.getElementById('user-input');\n            const sendButton = document.getElementById('send-button');\n            const themeToggleButton = document.getElementById('theme-toggle-button');\n            const sentiment = new Sentiment();\n\n            const getParticleOptions = (theme) => {\n                const isDark = theme === 'dark';\n                return {\n                    fpsLimit: 60,\n                    particles: {\n                        number: {\n                            value: 50,\n                            density: {\n                                enable: true,\n                                value_area: 800\n                            }\n                        },\n                        color: {\n                            value: isDark ? \"#00FF41\" : \"#1a1a1a\"\n                        },\n                        shape: {\n                            type: \"char\",\n                            character: {\n                                value: [\"0\", \"1\"],\n                                font: \"Courier New\",\n                                style: \"\",\n                                weight: \"400\",\n                                fill: true\n                            }\n                        },\n                        opacity: {\n                            value: 0.5,\n                            random: true\n                        },\n                        size: {\n                            value: 16,\n                            random: {\n                                enable: true,\n                                minimumValue: 8\n                            }\n                        },\n                        move: {\n                            enable: true,\n                            speed: 1,\n                            direction: \"none\",\n                            random: false,\n                            straight: false,\n                            out_mode: \"out\",\n                            bounce: false,\n                        }\n                    },\n                    interactivity: {\n                        events: {\n                            onhover: {\n                                enable: true,\n                                mode: \"repulse\"\n                            },\n                            onclick: {\n                                enable: true,\n                                mode: \"push\"\n                            },\n                            resize: true\n                        },\n                        modes: {\n                            repulse: {\n                                distance: 100,\n                                duration: 0.4\n                            },\n                            push: {\n                                particles_nb: 4\n                            }\n                        }\n                    },\n                    detectRetina: true,\n                };\n            };\n\n            const loadParticles = (theme) => {\n                tsParticles.load(\"tsparticles\", getParticleOptions(theme));\n            };\n\n            const applyTheme = (theme) => {\n                document.documentElement.setAttribute('data-theme', theme);\n                localStorage.setItem('theme', theme);\n                loadParticles(theme);\n            };\n\n            const currentTheme = localStorage.getItem('theme') || 'dark';\n            applyTheme(currentTheme);\n\n            themeToggleButton.addEventListener('click', () => {\n                const newTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';\n                applyTheme(newTheme);\n            });\n\n            const loadChatHistory = () => {\n                const history = JSON.parse(localStorage.getItem('chatHistory')) || [];\n                history.forEach(item => addMessage(item.sender, item.text, false));\n            };\n\n            const saveChatHistory = () => {\n                const messages = [];\n                chatMessages.querySelectorAll('.message-block').forEach(block => {\n                    const userPrompt = block.querySelector('.user-prompt');\n                    const aiMessage = block.querySelector('.ai-message');\n                    if (userPrompt) {\n                        messages.push({ sender: 'user', text: userPrompt.textContent });\n                    }\n                    if (aiMessage) {\n                        messages.push({ sender: 'ai', text: aiMessage.innerHTML });\n                    }\n                });\n                localStorage.setItem('chatHistory', JSON.stringify(messages));\n            };\n\n            const typeWriter = (element, text, onComplete) => {\n                let i = 0;\n                element.innerHTML = '';\n                const cursor = document.createElement('span');\n                cursor.className = 'typing-cursor';\n                element.appendChild(cursor);\n\n                function type() {\n                    if (i < text.length) {\n                        element.insertBefore(document.createTextNode(text.charAt(i)), cursor);\n                        i++;\n                        chatMessages.scrollTop = chatMessages.scrollHeight;\n                        setTimeout(type, 20);\n                    } else {\n                        element.removeChild(cursor);\n                        if (onComplete) onComplete();\n                    }\n                }\n                type();\n            };\n\n            const addMessage = (sender, text, isTyping) => {\n                if (sender === 'user') {\n                    const messageBlock = document.createElement('div');\n                    messageBlock.className = 'message-block';\n                    const userLine = document.createElement('div');\n                    userLine.className = 'user-prompt';\n                    userLine.textContent = text;\n                    messageBlock.appendChild(userLine);\n                    chatMessages.appendChild(messageBlock);\n                } else { \n                    const lastBlock = chatMessages.lastElementChild;\n                    const aiMessage = document.createElement('div');\n                    aiMessage.className = 'ai-message';\n                    \n                    if (isTyping) {\n                        typeWriter(aiMessage, text, () => {\n                            renderMarkdown(aiMessage);\n                            saveChatHistory();\n                        });\n                    } else {\n                        aiMessage.innerHTML = text;\n                        renderMarkdown(aiMessage);\n                    }\n                    lastBlock.appendChild(aiMessage);\n                }\n                chatMessages.scrollTop = chatMessages.scrollHeight;\n            };\n\n            const renderMarkdown = (element) => {\n                element.innerHTML = marked.parse(element.innerHTML);\n                element.querySelectorAll('pre code').forEach((block) => {\n                    hljs.highlightElement(block);\n                    const pre = block.parentElement;\n                    const copyButton = document.createElement('button');\n                    copyButton.innerText = 'Copy';\n                    copyButton.className = 'copy-button';\n                    copyButton.addEventListener('click', () => {\n                        navigator.clipboard.writeText(block.innerText).then(() => {\n                            copyButton.innerText = 'Copied!';\n                            setTimeout(() => { copyButton.innerText = 'Copy'; }, 2000);\n                        });\n                    });\n                    pre.appendChild(copyButton);\n                });\n            };\n\n            const showTypingIndicator = () => {\n                const lastBlock = chatMessages.lastElementChild;\n                if (!lastBlock) return;\n                const indicator = document.createElement('div');\n                indicator.className = 'typing-indicator';\n                indicator.innerHTML = '<span></span><span></span><span></span>';\n                lastBlock.appendChild(indicator);\n                chatMessages.scrollTop = chatMessages.scrollHeight;\n                return indicator;\n            };\n\n            const getAIResponse = (message) => {\n                const lowerCaseMessage = message.toLowerCase();\n                if (lowerCaseMessage.startsWith('wiki:')) {\n                    const query = message.substring(5).trim();\n                    return fetch(`https://it.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`)\n                        .then(response => response.json())\n                        .then(data => data.extract || 'Non ho trovato informazioni su questo argomento.')\n                        .catch(() => 'Errore nel contattare Wikipedia.');\n                } else if (lowerCaseMessage.startsWith('sentiment:')) {\n                    const text = message.substring(10).trim();\n                    const result = sentiment.analyze(text);\n                    return Promise.resolve(`Analisi del sentiment:\\n- Punteggio: ${result.score}\\n- Positivi: ${result.positive.join(', ')}\\n- Negativi: ${result.negative.join(', ')}`);\n                } else if (lowerCaseMessage.startsWith('news:')) {\n                    return Promise.resolve('La funzione notizie non Ã¨ ancora implementata.');\n                } else {\n                    return Promise.resolve('Comando non riconosciuto. Prova con `wiki: <termine>`, `sentiment: <testo>`.');\n                }\n            };\n\n            const handleSend = () => {\n                const message = userInput.value.trim();\n                if (!message) return;\n\n                addMessage('user', message, false);\n                userInput.value = '';\n                userInput.style.height = 'auto';\n\n                const typingIndicator = showTypingIndicator();\n\n                setTimeout(() => {\n                    getAIResponse(message).then(response => {\n                        if (typingIndicator) typingIndicator.remove();\n                        addMessage('ai', response, true);\n                    });\n                }, 1000);\n            };\n\n            sendButton.addEventListener('click', handleSend);\n            userInput.addEventListener('keydown', (e) => {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    handleSend();\n                }\n            });\n\n            userInput.addEventListener('input', () => {\n                userInput.style.height = 'auto';\n                userInput.style.height = (userInput.scrollHeight) + 'px';\n            });\n\n            loadChatHistory();\n        });\n    </script>\n</body>\n</html>